name: ðŸš€ Deploy to Server

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout del cÃ³digo
        uses: actions/checkout@v3

      - name: ðŸš€ Desplegar en servidor
        run: |
          ssh -v -o StrictHostKeyChecking=no deploy@tl-showroom.equalitech.xyz << 'EOF'
            mkdir -p /opt/easyengine/sites/tl-showroom.equalitech.xyz/app/backend
            cd /opt/easyengine/sites/tl-showroom.equalitech.xyz/app/backend

            if [ ! -d ".git" ]; then
              echo "âš ï¸ Repo no clonado, clonando ahora..."
              git clone git@github.com:jupahefi/.git .
            else
              echo "ðŸ“¥ Repo ya clonado, actualizando..."
              git pull origin main
            fi

            echo "ðŸš€ Ejecutando deploy..."
            bash deploy.sh

            echo "âœ… Despliegue completado!"
          EOF
